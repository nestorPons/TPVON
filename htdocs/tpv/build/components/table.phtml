<?php namespace app\controllers\components?>
<table id="<?=$idElement?>" class="<?= $class ?>">
    <thead>
        <?php foreach ($columns as $key => $val) : ?>
            <th class="<?= $val ?>"><?= $val ?></th>
        <?php endforeach ?>
    </thead>
    <tbody>
    </tbody>
    <tfoot>
        <?php if($total) :?>
        <tr>
            <td>TOTAL : <span class="id_total"></span> </td>
        </tr>
        <?php endif ?>
    </tfoot>
</table>
<template id="template_<?= $id ?>">
    <tr 
        <?= $onclick ?> 
        <?= $ondblclick ?>
    >
        <?php foreach ($columns as $key => $val) : ?>
            <td class="<?= $val ?>" data-label=""></td>
        <?php endforeach ?>
    </tr>
</template>
<style>
    #<?=$idElement?> tfoot {
        order   : 3;
        width   : 100%;
    }
    #<?=$idElement?> tfoot tr{
        text-align  : right;
    }
</style>
<script>
var Table = class{
    constructor(id){
        this.table = document.getElementById('<?= $idElement ?>')
        this.$table = $('#' + id)
        this.$template =  $( $('#template_' + id)[0].innerHTML )
    }
    /**
     * arrData = array de datos en orden de salida
     */
    addLine(id, arrData){
        return this.$template
            .clone()
            .attr('idline', id || this.$table.find('tr').length)
            .find('td').each(function(i, el){
                $(this)
                    .html(arrData[i])
                    .attr('data-label', arrData[i])
            })
            .end()
            .prependTo(this.$table.find('tbody'))      
    }
    endScroll(){
        this.$table.animate({ scrollTop: this.$table.height() }, 100);
    }
    clearLines(){
        this.$table.find('tbody').find('tr').remove()
    }
    clear(){
        this.clearLines()
    }
    delLine(id){
        this.$table.find(`[idline="${id}"]`).remove()
    }
    updateLine(id, data){
        this.delLine(id)
        return this.addLine(id, data)
    }
    total(arg){
        const total = this.table.getElementsByClassName('id_total')[0]
        if(arg) total.innerHTML = arg
        return total.innerHTML
    }
}
</script>