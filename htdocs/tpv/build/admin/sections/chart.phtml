<?php namespace app\controllers\components?><section id="chart">
    <?php 
    new MenuSquare([
        'tile' => 'Gráfica Iconos', 
        'content' => '<canvas id="myChart" width="600px" height="600px"></canvas>'
        ])
    ?>
        <?php 
    new MenuSquare([
        'tile' => 'Gráfica Iconos 2', 
        'content' => '<canvas id="myChart" width="400px" height="400px"></canvas>'
        ])
    ?>
    <script>app.chart={buttons:[],load(){app.post({controller:'tickets',action:'getAll',data:null},data=>{let _mySort=arr=>{let sortedKeys=new Array();let sortedObj={};for(let i in arr){sortedKeys.push(i)}
sortedKeys.sort(function(a,b){dateA=date.sql(a)
dateB=date.sql(b)
return new Date(dateA)-new Date(dateB)});for(let i in sortedKeys){sortedObj[sortedKeys[i]]=arr[sortedKeys[i]]}
return sortedObj}
DB.set('tickets',data)
let arr=[],labels=[],datas=[];for(let i in data){const d=data[i]
if(d){const k=date.short(d.fecha)
if(arr[k]!=undefined)arr[k]+=d.total
else arr[k]=d.total}}
let a=_mySort(arr)
for(let i in a){labels.push(i)
datas.push(arr[i])}
let ctx=document.getElementById('myChart');let myChart=new Chart(ctx,{type:'bar',data:{labels:labels,datasets:[{label:'Ingresos por día',data:datas,backgroundColor:['rgba(255, 99, 132, 0.2)','rgba(54, 162, 235, 0.2)','rgba(255, 206, 86, 0.2)','rgba(75, 192, 192, 0.2)','rgba(153, 102, 255, 0.2)','rgba(255, 159, 64, 0.2)'],borderColor:['rgba(255, 99, 132, 1)','rgba(54, 162, 235, 1)','rgba(255, 206, 86, 1)','rgba(75, 192, 192, 1)','rgba(153, 102, 255, 1)','rgba(255, 159, 64, 1)'],borderWidth:1}]},options:{responsive:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})})}}</script>
</section>

